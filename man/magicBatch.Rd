% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/magicBatch.R
\name{magicBatch}
\alias{magicBatch}
\title{Impute data using the MAGIC algorithm}
\usage{
magicBatch(data, aff_mat_input = NULL, pca = 20, t = 2,
  n_diffusion_components = 10, k = 9, ka = 3, epsilon = 1,
  rescale = 0, python_command = "python3")
}
\arguments{
\item{data}{An expression matrix where cells correspond to rows and genes correspond to columns}

\item{aff_mat_input}{A matrix where cells correspond to rows and components correspond to columns. If left unspecified, the affinity matrix calculation is initialized with PCA as in the original implementation.}

\item{pca}{An integer specifying the number of PCA components that should be used}

\item{t}{The power to which the marcov matrix is to be raised}

\item{n_diffusion_components}{Number of diffusion map components to compute.}

\item{k}{The number of nearest neighbors used to construct the knn graph}

\item{ka}{This controls the standard deviation used in the Gaussian kernel width for a given cell, which is set to the distance to the ka-th nearest neighbor.}

\item{epsilon}{Epsilon parameter used in MAGIC}

\item{rescale}{Percentile to rescale data to after imputation}

\item{python_command}{A character string passed to the "command" arugment of the system2 function in order to invoke python.}
}
\value{
A \code{list} that includes the following elements:
\describe{
  \item{imputed_data}{A cell by gene \code{matrix} of the imputed gene expression values.}
  \item{diffusion_map}{A cell by diffusion map component \code{matrix}.}
  \item{affinity_matrix}{A cell by cell \code{matrix} of the unpowered markov affinity matrix.}
}
}
\description{
This is an R wrapper for the orginal python implementation of the Marcov Affinity-based Graph Imputation of Cells (MAGIC) algorithm as described in 
Van Dijk, David et al. The default behavior of the orginal python implementation is slightly different and sometimes preferable to the existing R 
implementation of MAGIC (Rmagic::magic). magicBatch also includes support for imputation across multiple batches: the optional aff_mat_input argument
allows the user to pass any low-dimensional representation of the data, including batch-corrected data, directly to the calculation of the powered marcov 
affinity matrix, resulting in cross-batch imputation that preserves batch-specific differences.
}
\author{
Kevin Brulois
}
